<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    // Set theme immediately to prevent flash
    (function() {
      const stored = localStorage.getItem('theme');
      if (stored) {
        document.documentElement.setAttribute('data-theme', stored);
      }
    })();
  </script>
   <link rel="stylesheet" href="/BioTutorials/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github.min.css" id="hljs-light">
<link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github-dark.min.css" id="hljs-dark" disabled>
<script>
  // Set initial highlight theme based on current theme
  (function() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark' ||
      (!document.documentElement.getAttribute('data-theme') &&
       window.matchMedia('(prefers-color-scheme: dark)').matches);
    document.getElementById('hljs-light').disabled = isDark;
    document.getElementById('hljs-dark').disabled = !isDark;
  })();
</script>
   
  <link rel="stylesheet" href="/BioTutorials/css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">

<link rel="icon" type="image/png" sizes="192x192" href="/BioTutorials/assets/favicon.png">
<link rel="shortcut icon" href="/BioTutorials/assets/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/BioTutorials/assets/apple-touch-icon.png">


   <title>Problem 3: Reverse Complement - BioJulia</title>  
</head>
<body>
  <header class="site-header">
  <div class="header-content">
    <div class="header-left">
      <a href="https://biojulia.dev/BioTutorials" class="logo-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 136.48101 51.472999" height="32" aria-label="BioJulia">
          <g id="bubble-helix">
            <circle cx="5.9792" cy="20.3" r="5.9792" fill="#945bb0"/>
            <circle cx="21.317" cy="39.5" r="4.9393" fill="#4266d5"/>
            <circle cx="16.378" cy="11.7" r="4.9393" fill="#c93d39"/>
            <circle cx="35.095" cy="35.9" r="5.9792" fill="#945bb0"/>
            <circle cx="47.184" cy="23.8" r="7.409" fill="#4266d5"/>
            <circle cx="28.986" cy="9.7" r="4.5494" fill="#3b972e"/>
            <circle cx="89.428" cy="46.5" r="4.9393" fill="#c93d39"/>
            <circle cx="71.62" cy="5.6" r="5.5892" fill="#945bb0"/>
            <circle cx="121.01" cy="15.5" r="5.5892" fill="#c93d39"/>
            <circle cx="59.662" cy="30.3" r="2.4697" fill="#4266d5"/>
            <circle cx="103.6" cy="19.9" r="3.2496" fill="#c93d39"/>
            <circle cx="123.61" cy="36.5" r="2.7296" fill="#4266d5"/>
            <circle cx="127.64" cy="5.2" r="3.8995" fill="#3b972e"/>
            <circle cx="132.58" cy="39.2" r="3.8995" fill="#945bb0"/>
            <circle cx="67.591" cy="37.4" r="3.3795" fill="#3b972e"/>
            <circle cx="95.017" cy="13.9" r="4.2894" fill="#4266d5"/>
            <circle cx="77.729" cy="42.9" r="3.8995" fill="#945bb0"/>
            <circle cx="102.56" cy="42.0" r="5.8492" fill="#4266d5"/>
            <circle cx="113.6" cy="28.8" r="6.7591" fill="#3b972e"/>
            <circle cx="57.582" cy="11.0" r="6.3691" fill="#c93d39"/>
            <circle cx="38.735" cy="14.8" r="3.3795" fill="#c93d39"/>
            <circle cx="84.618" cy="7.9" r="5.3293" fill="#3b972e"/>
          </g>
        </svg>
        <span>BioTutorials</span>
      </a>
    </div>
    <nav class="header-nav">
      <a href="/BioTutorials/">Tutorials</a>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </nav>
  </div>
</header>

  <main class="franklin-content">

<div class="franklin-content" >
  <h1 id="problem_3_reverse_complement" ><a href="#problem_3_reverse_complement"> ðŸ˜‰ Problem 3: Reverse Complement</a></h1><p>I know, I know, <a href="https://www.grammarly.com/blog/complement-compliment/">not the <em>compliment</em></a>, but if you have a better emoji idea, let me know.</p>
<p>ðŸ¤” <a href="https://rosalind.info/problems/revc/">Problem link</a></p>
<blockquote><p><strong>The Problem</strong></p>
<p>In DNA strings, symbols 'A' and 'T' are complements of each other, as are 'C' and 'G'.</p>
<p>The reverse complement of a DNA string \(s\) is the string \(sc\) formed by reversing the symbols of \(s\),
then taking the complement of each symbol (e.g., the reverse complement of "GTCA" is "TGAC").</p>
<p><em>Given</em>: A DNA string \(s\) of length at most 1000 bp.</p>
<p><em>Return</em>: The reverse complement \(sc\) of \(s\).</p>
<p><strong>Sample Dataset</strong></p>
<pre><code class="julia">AAAACCCGGT</code></pre>
<p><strong>Sample Output</strong></p>
<pre><code class="julia">ACCGGGTTTT</code></pre>
</blockquote><p>This one is a bit tougher - we need to change each base coming in,
and then reverse the result. Actually, that second part is easy,
because julia has a built-in <code>reverse()</code> function that works for <code>String</code>s.</p>
<pre><code class="julia">reverse(&quot;complement&quot;)  # &quot;tnemelpmoc&quot;</code></pre>
<h3 id="approach_1_using_a_dictionary" ><a href="#approach_1_using_a_dictionary"> Approach 1: using a <code>Dict</code>ionary</a></h3><p>In my opinion, the easiest thing to do is to use a <code>Dict()</code>,
a data structure that allows arbitrary keys to look up arbitrary entries.</p>
<p>For example:</p>
<pre><code class="julia">my_dictionary = Dict(&quot;thing1&quot;=&gt; &quot;hello&quot;, &quot;thing2&quot; =&gt; &quot;world!&quot;)

my_dictionary[&quot;thing1&quot;]  # &quot;hello&quot;
my_dictionary[&quot;thing2&quot;]  # &quot;world!&quot;</code></pre>
<p>So, we just make a dictionary with 4 entries, one for each base.
Then, to apply this to every base in the sequence, we have a couple of options.
One is to use the <code>String()</code> constructor and a "comprehension" -
basically a <code>for</code> loop in a single phrase:</p>
<pre><code class="julia">function revc(seq)
    comp_dict = Dict(
        'A'=&gt;'T',
        'C'=&gt;'G',
        'G'=&gt;'C',
        'T'=&gt;'A'
    )
    comp = String([comp_dict[base] for base in seq])
    return reverse(comp)
end</code></pre>
<p>Here, the "comprehension" <code>[comp_dict[base] for base in seq]</code> is equivalent to something like</p>
<pre><code class="julia">comp = Char[]
for base in seq
    push!(comp, comp_dict[base])
end</code></pre>
<p>So let's see if it works!</p>
<pre><code class="julia">input_dna = &quot;AAAACCCGGT&quot;
answer = &quot;ACCGGGTTTT&quot;

@assert revc(input_dna) == answer</code></pre>
<h3 id="approach_2_using_replace()_again" ><a href="#approach_2_using_replace()_again"> Approach 2: using <code>replace()</code> again</a></h3><p>It turns out, the <code>replace()</code> function we used for the transcription problem
can be passed multiple <code>Pair</code>s of patterns to replace!</p>
<p>So we can just pass the pairs directly:</p>
<pre><code class="julia">function revc2(seq)
    comp = replace(seq,
        'A'=&gt;'T',
        'C'=&gt;'G',
        'G'=&gt;'C',
        'T'=&gt;'A'
    )
    return reverse(comp)
end

@assert revc(input_dna) == revc2(input_dna)</code></pre>
<h3 id="approach_3_biosequences.jl" ><a href="#approach_3_biosequences.jl"> Approach 3: <code>BioSequences.jl</code></a></h3><p>This is a pretty common need in bioinformatics, so <code>BioSequences.jl</code> actually has a <code>reverse_complement()</code> function built-in.</p>
<pre><code class="julia">using BioSequences

reverse_complement(LongDNA&lbrace;2&rbrace;(input_dna))  # ACCGGGTTTT</code></pre>
<h3 id="benchmarks" ><a href="#benchmarks"> Benchmarks</a></h3><pre><code class="julia">using BenchmarkTools

testseq = randdnaseq(100_000) #this is defined in BioSequences
testseq_str = string(testseq)

@benchmark revc($testseq_str)
@benchmark revc2($testseq_str)
@benchmark reverse_complement($testseq)
@benchmark reverse_complement(testseq_4bit) setup=(testseq_4bit = convert(LongDNA&lbrace;4&rbrace;, testseq))</code></pre>
<h3 id="conclusions" ><a href="#conclusions"> Conclusions</a></h3><p>This one is a no-brainer! The <code>reverse_complement()</code> function is about 200x faster than the dictionary method, and about 1000x faster than <code>replace()</code> for both 2 bit and 4 bit DNA sequences.</p>
<h2 id="overall_conclusions" ><a href="#overall_conclusions"> âŒ› Overall Conclusions</a></h2><p>A lot of bioinformatics is essentially string manipulation.
Julia has a lot of useful functionality to work with <code>String</code>s
directly, but those methods often leave a lot of performance on the table.</p>
<p><code>BioSequences.jl</code> provides some nice sequence types and incredibly efficient
data structures. We'll be seeing more of them in coming tutorials.</p>

  <footer class="page-foot">
  <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> BioJulia Developers
   Â· Last modified: 
  <br>
  Built with <a href="https://github.com/tlienart/Xranklin.jl">Xranklin.jl</a>
</footer>

</div>

  </main>
  
    <script src="/BioTutorials/libs/katex/katex.min.js"></script>
<script src="/BioTutorials/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

  
  
    <script src="/BioTutorials/libs/highlight/julia-custom.min.js"></script>
<script>
  // Configure highlight.js to recognize Xranklin's class format
  document.querySelectorAll('pre code').forEach((el) => {
    if (el.className && !el.className.startsWith('language-')) {
      el.classList.add('language-' + el.className.split(' ')[0]);
    }
  });
  hljs.highlightAll();
</script>

  
  <script>
    // Theme toggle functionality
    (function() {
      const toggle = document.getElementById('theme-toggle');
      if (!toggle) return;

      function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      function getCurrentTheme() {
        const stored = localStorage.getItem('theme');
        if (stored) return stored;
        return getSystemTheme();
      }

      function updateHighlightTheme(isDark) {
        const lightStyle = document.getElementById('hljs-light');
        const darkStyle = document.getElementById('hljs-dark');
        if (lightStyle && darkStyle) {
          lightStyle.disabled = isDark;
          darkStyle.disabled = !isDark;
        }
      }

      toggle.addEventListener('click', function() {
        const current = getCurrentTheme();
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateHighlightTheme(next === 'dark');
      });

      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
          // Only update if user hasn't manually set a preference
          document.documentElement.removeAttribute('data-theme');
          updateHighlightTheme(e.matches);
        }
      });
    })();
  </script>
</body>
</html>
