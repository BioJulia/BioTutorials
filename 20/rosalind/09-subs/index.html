<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    // Set theme immediately to prevent flash
    (function() {
      const stored = localStorage.getItem('theme');
      if (stored) {
        document.documentElement.setAttribute('data-theme', stored);
      }
    })();
  </script>
  
   <link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github.min.css" id="hljs-light">
<link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github-dark.min.css" id="hljs-dark" disabled>
<script>
  // Set initial highlight theme based on current theme
  (function() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark' ||
      (!document.documentElement.getAttribute('data-theme') &&
       window.matchMedia('(prefers-color-scheme: dark)').matches);
    document.getElementById('hljs-light').disabled = isDark;
    document.getElementById('hljs-dark').disabled = !isDark;
  })();
</script>
   
  <link rel="stylesheet" href="/BioTutorials/css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">

<link rel="icon" type="image/png" sizes="192x192" href="/BioTutorials/assets/favicon.png">
<link rel="shortcut icon" href="/BioTutorials/assets/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/BioTutorials/assets/apple-touch-icon.png">


   <title>Finding a Motif in DNA - BioJulia</title>  
</head>
<body>
  <header class="site-header">
  <div class="header-content">
    <div class="header-left">
      <a href="https://biojulia.dev/BioTutorials" class="logo-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 136.48101 51.472999" height="32" aria-label="BioJulia">
          <g id="bubble-helix">
            <circle cx="5.9792" cy="20.3" r="5.9792" fill="#945bb0"/>
            <circle cx="21.317" cy="39.5" r="4.9393" fill="#4266d5"/>
            <circle cx="16.378" cy="11.7" r="4.9393" fill="#c93d39"/>
            <circle cx="35.095" cy="35.9" r="5.9792" fill="#945bb0"/>
            <circle cx="47.184" cy="23.8" r="7.409" fill="#4266d5"/>
            <circle cx="28.986" cy="9.7" r="4.5494" fill="#3b972e"/>
            <circle cx="89.428" cy="46.5" r="4.9393" fill="#c93d39"/>
            <circle cx="71.62" cy="5.6" r="5.5892" fill="#945bb0"/>
            <circle cx="121.01" cy="15.5" r="5.5892" fill="#c93d39"/>
            <circle cx="59.662" cy="30.3" r="2.4697" fill="#4266d5"/>
            <circle cx="103.6" cy="19.9" r="3.2496" fill="#c93d39"/>
            <circle cx="123.61" cy="36.5" r="2.7296" fill="#4266d5"/>
            <circle cx="127.64" cy="5.2" r="3.8995" fill="#3b972e"/>
            <circle cx="132.58" cy="39.2" r="3.8995" fill="#945bb0"/>
            <circle cx="67.591" cy="37.4" r="3.3795" fill="#3b972e"/>
            <circle cx="95.017" cy="13.9" r="4.2894" fill="#4266d5"/>
            <circle cx="77.729" cy="42.9" r="3.8995" fill="#945bb0"/>
            <circle cx="102.56" cy="42.0" r="5.8492" fill="#4266d5"/>
            <circle cx="113.6" cy="28.8" r="6.7591" fill="#3b972e"/>
            <circle cx="57.582" cy="11.0" r="6.3691" fill="#c93d39"/>
            <circle cx="38.735" cy="14.8" r="3.3795" fill="#c93d39"/>
            <circle cx="84.618" cy="7.9" r="5.3293" fill="#3b972e"/>
          </g>
        </svg>
        <span>BioTutorials</span>
      </a>
    </div>
    <nav class="header-nav">
      <a href="/BioTutorials/">Tutorials</a>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </nav>
  </div>
</header>

  <main class="franklin-content">

<div class="franklin-content" >
  <h1 id="finding_a_motif_in_dna" ><a href="#finding_a_motif_in_dna"> Finding a Motif in DNA</a></h1><p>ðŸ¤” <a href="https://rosalind.info/problems/subs/">Problem link</a></p>
<p>!!! warning "The Problem"</p>
<p>    Given two strings s and t, 
    t is a substring of s if t is contained as a contiguous collection of symbols in s 
    (as a result, t must be no longer than s).</p>
<p>    The position of a symbol in a string is the total number of symbols found to its left, including itself.    
    (e.g., the positions of all occurrences of 'U' in "AUGCUUCAGAAAGGUCUUACG" are 2, 5, 6, 15, 17, and 18).   
    The symbol at position i of s is denoted by s[i].</p>
<p>    A substring of s can be represented as s[j:k],   
    where j and k represent the starting and ending positions of the substring in s;    
    for example, if s= "AUGCUUCAGAAAGGUCUUACG",   
    then s[2:5]= "UGCU".</p>
<p>    The location of a substring s[j:k]is its beginning position j;   
    note that t will have multiple locations in s
    if it occurs more than once as a substring of s.
    (see the Sample below).</p>
<p>    Given: 
    Two DNA strings s and t.  
    (each of length at most 1 kbp).</p>
<p>    Return: 
    All locations of t as a substring of s.  </p>
<p>    Sample Dataset
    <code>GATATATGCATATACTTATAT</code></p>
<p>    Sample Output
    <code>2 4 10</code></p>
<h3 id="handwritten_solution" ><a href="#handwritten_solution"> Handwritten solution</a></h3><p>Let's start off with the most verbose solution.  
We can loop over every character within the input string and  
check if we can find the substring in the subsequent characters.  </p>
<p>In other words,   
we will check each index for an exact match to the substring we are searching for. </p>
<pre><code class="julia">dataset = &quot;GATATATGCATATACTTATAT&quot;
search_string = &quot;ATAT&quot;

function haystack(substring, string)
    # check if the strings are empty
    if isempty(substring) || isempty(string)
        throw(ErrorException(&quot;empty sequences&quot;))
    end

    # check that string exists in data
    if ! occursin(substring, string)
        return []
    end

    output = []
    for i in eachindex(string)
        # check if first letter of string matches character at the index
        if string[i] == substring[1]
            # check if full substring matches at index
            # make sure not to search index past string 
            if i + length(substring) - 1 &lt;= length(string) &amp;&amp; string[i:i+length(substring)-1] == substring
                push!(output, i)
            end
        end
    end
    return output
end

haystack(search_string, dataset)</code></pre>
<h3 id="biojulia_solution" ><a href="#biojulia_solution"> Biojulia solution</a></h3><p>The BioSequences package has a helpful function <a href="https://github.com/BioJulia/BioSequences.jl/blob/b626dbcaad76217b248449e6aa2cc1650e95660c/src/BioSequences.jl#L261-L316"><code>findall</code></a>, 
which returns the indices of all exact string matches.   </p>
<p>It isn't included in the documentation about exact string search <a href="https://biojulia.dev/BioSequences.jl/v2.0/sequence_search/#Exact-search-1">here</a>,   
but the function exists!  </p>
<p>BioSequences has other helpful exact string search functions like <code>findfirst</code>, <code>firstnext</code>, and <code>findlast</code>.   </p>
<pre><code class="julia">function haystack_findall(substring, string)
    # check if the strings are empty
    if isempty(substring) || isempty(string)
        throw(ErrorException(&quot;empty sequences&quot;))
    end

    # check that string exists in data
    if ! occursin(substring, string)
        return []
    end

    matches = findall(ExactSearchQuery(dna&quot;$substring&quot;),dna&quot;$string&quot;)
    return first.(matches)
end
    

haystack_findall(search_string, dataset)</code></pre>
<h3 id="regex_solution" ><a href="#regex_solution"> Regex solution</a></h3><p>Lastly, we can also use Regex's search function.   
Here the "pattern" we are searching for is the exact string.   
This is the a great solution if we wanted to look for patterns of more complicated strings,   
but it works for exact matches as well!</p>
<pre><code class="julia">function haystack_regex(substring, string)
    if isempty(substring) || isempty(string)
        throw(ErrorException(&quot;emptysequences&quot;))                            
    end                                                                                                                             
    if !occursin(substring, string)            
          return[]    
    end    
    
    return [m.offset for m in eachmatch(Regex(substring), string, overlap=true) ] 
end

haystack_findnext(search_string, dataset)</code></pre>

  <footer class="page-foot">
  <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> BioJulia Developers
   Â· Last modified: 
  <br>
  Built with <a href="https://github.com/tlienart/Xranklin.jl">Xranklin.jl</a>
</footer>

</div>

  </main>
  
  
    <script src="/BioTutorials/libs/highlight/julia-custom.min.js"></script>
<script>
  // Configure highlight.js to recognize Xranklin's class format
  document.querySelectorAll('pre code').forEach((el) => {
    if (el.className && !el.className.startsWith('language-')) {
      el.classList.add('language-' + el.className.split(' ')[0]);
    }
  });
  hljs.highlightAll();
</script>

  
  <script>
    // Theme toggle functionality
    (function() {
      const toggle = document.getElementById('theme-toggle');
      if (!toggle) return;

      function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      function getCurrentTheme() {
        const stored = localStorage.getItem('theme');
        if (stored) return stored;
        return getSystemTheme();
      }

      function updateHighlightTheme(isDark) {
        const lightStyle = document.getElementById('hljs-light');
        const darkStyle = document.getElementById('hljs-dark');
        if (lightStyle && darkStyle) {
          lightStyle.disabled = isDark;
          darkStyle.disabled = !isDark;
        }
      }

      toggle.addEventListener('click', function() {
        const current = getCurrentTheme();
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateHighlightTheme(next === 'dark');
      });

      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
          // Only update if user hasn't manually set a preference
          document.documentElement.removeAttribute('data-theme');
          updateHighlightTheme(e.matches);
        }
      });
    })();
  </script>
</body>
</html>
