<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    // Set theme immediately to prevent flash
    (function() {
      const stored = localStorage.getItem('theme');
      if (stored) {
        document.documentElement.setAttribute('data-theme', stored);
      }
    })();
  </script>
   <link rel="stylesheet" href="/BioTutorials/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github.min.css" id="hljs-light">
<link rel="stylesheet" href="/BioTutorials/libs/highlight/styles/github-dark.min.css" id="hljs-dark" disabled>
<script>
  // Set initial highlight theme based on current theme
  (function() {
    const isDark = document.documentElement.getAttribute('data-theme') === 'dark' ||
      (!document.documentElement.getAttribute('data-theme') &&
       window.matchMedia('(prefers-color-scheme: dark)').matches);
    document.getElementById('hljs-light').disabled = isDark;
    document.getElementById('hljs-dark').disabled = !isDark;
  })();
</script>
   
  <link rel="stylesheet" href="/BioTutorials/css/style.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">

<link rel="icon" type="image/png" sizes="192x192" href="/BioTutorials/assets/favicon.png">
<link rel="shortcut icon" href="/BioTutorials/assets/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/BioTutorials/assets/apple-touch-icon.png">


   <title>Problem 2: Transcription - BioJulia</title>  
</head>
<body>
  <header class="site-header">
  <div class="header-content">
    <div class="header-left">
      <a href="https://biojulia.dev/BioTutorials" class="logo-link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 136.48101 51.472999" height="32" aria-label="BioJulia">
          <g id="bubble-helix">
            <circle cx="5.9792" cy="20.3" r="5.9792" fill="#945bb0"/>
            <circle cx="21.317" cy="39.5" r="4.9393" fill="#4266d5"/>
            <circle cx="16.378" cy="11.7" r="4.9393" fill="#c93d39"/>
            <circle cx="35.095" cy="35.9" r="5.9792" fill="#945bb0"/>
            <circle cx="47.184" cy="23.8" r="7.409" fill="#4266d5"/>
            <circle cx="28.986" cy="9.7" r="4.5494" fill="#3b972e"/>
            <circle cx="89.428" cy="46.5" r="4.9393" fill="#c93d39"/>
            <circle cx="71.62" cy="5.6" r="5.5892" fill="#945bb0"/>
            <circle cx="121.01" cy="15.5" r="5.5892" fill="#c93d39"/>
            <circle cx="59.662" cy="30.3" r="2.4697" fill="#4266d5"/>
            <circle cx="103.6" cy="19.9" r="3.2496" fill="#c93d39"/>
            <circle cx="123.61" cy="36.5" r="2.7296" fill="#4266d5"/>
            <circle cx="127.64" cy="5.2" r="3.8995" fill="#3b972e"/>
            <circle cx="132.58" cy="39.2" r="3.8995" fill="#945bb0"/>
            <circle cx="67.591" cy="37.4" r="3.3795" fill="#3b972e"/>
            <circle cx="95.017" cy="13.9" r="4.2894" fill="#4266d5"/>
            <circle cx="77.729" cy="42.9" r="3.8995" fill="#945bb0"/>
            <circle cx="102.56" cy="42.0" r="5.8492" fill="#4266d5"/>
            <circle cx="113.6" cy="28.8" r="6.7591" fill="#3b972e"/>
            <circle cx="57.582" cy="11.0" r="6.3691" fill="#c93d39"/>
            <circle cx="38.735" cy="14.8" r="3.3795" fill="#c93d39"/>
            <circle cx="84.618" cy="7.9" r="5.3293" fill="#3b972e"/>
          </g>
        </svg>
        <span>BioTutorials</span>
      </a>
    </div>
    <nav class="header-nav">
      <a href="/BioTutorials/">Tutorials</a>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"></circle>
          <line x1="12" y1="1" x2="12" y2="3"></line>
          <line x1="12" y1="21" x2="12" y2="23"></line>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
          <line x1="1" y1="12" x2="3" y2="12"></line>
          <line x1="21" y1="12" x2="23" y2="12"></line>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
      </button>
    </nav>
  </div>
</header>

  <main class="franklin-content">

<div class="franklin-content" >
  <h1 id="problem_2_transcription" ><a href="#problem_2_transcription"> ‚úçÔ∏è Problem 2: Transcription</a></h1><p>ü§î <a href="https://rosalind.info/problems/rna/">Problem link</a></p>
<blockquote><p><strong>The Problem</strong></p>
<p>An RNA string is a string formed from the alphabet containing 'A', 'C', 'G', and 'U'.</p>
<p>Given a DNA string \(t\) corresponding to a coding strand,
its transcribed RNA string \(u\) is formed
by replacing all occurrences of 'T' in \(t\) with 'U' in \(u\).</p>
<p><em>Given</em>: A DNA string \(t\) having length at most 1000 nt.</p>
<p><em>Return</em>: The transcribed RNA string of \(t\).</p>
<p><strong>Sample Dataset</strong></p>
<pre><code class="julia">GATGGAACTTGACTACGTAAATT</code></pre>
<p><strong>Sample Output</strong></p>
<pre><code class="julia">GAUGGAACUUGACUACGUAAAUU</code></pre>
</blockquote><h3 id="approach_1_string_replace()" ><a href="#approach_1_string_replace()"> Approach 1 - string <code>replace()</code></a></h3><pre><code class="julia">input_dna = &quot;GATGGAACTTGACTACGTAAATT&quot;
answer = &quot;GAUGGAACUUGACUACGUAAAUU&quot;</code></pre>
<p>This one is pretty straightforward, as described.
All we need to do is replace any <code>'T'</code>s with <code>'U'</code>s.
Happily, julia has a handy <code>replace()</code> function
that takes a string, and a <code>Pair</code> that is <code>pattern =&gt; replacement</code>.
In principle, the pattern can be a literal <code>String</code>,
or even a regular expression. But here, we can just use a <code>Char</code>.</p>
<p>I'll also write the function using julia's one-line function definition syntax:</p>
<pre><code class="julia">simple_transcribe(seq) = replace(seq, 'T'=&gt; 'U')

@assert simple_transcribe(input_dna) == answer</code></pre>
<p>As always, there are lots of ways you <em>could</em> do this.
This function won't handle poorly formatted sequences,
for example. Or rather, it will handle them, even though it shouldn't:</p>
<pre><code class="julia">simple_transcribe(&quot;This Is QUITE silly&quot;)  # &quot;This Is QUIUE silly&quot;</code></pre>
<h3 id="approach_2_biosequences_longrna" ><a href="#approach_2_biosequences_longrna"> Approach 2 - BioSequences <code>LongRNA</code></a></h3><p>As you might expect, <code>BioSequences.jl</code> has a way to do this as well.
<code>BioSequences.jl</code> doesn't just use a <code>String</code> to represent sequences,
there are special types that can efficiently encode nucleic acid
or amino acid sequences.
In some cases, eg DNA or RNA with no ambiguous bases, using as few as 2 bits
per base.</p>
<pre><code class="julia">using BioSequences

dna_seq = LongDNA&lbrace;2&rbrace;(input_dna)

simple_transcribe(seq::LongDNA&lbrace;N&rbrace;) where N = LongRNA&lbrace;N&rbrace;(seq)

rna_seq = simple_transcribe(dna_seq)

@assert String(rna_seq) == answer</code></pre>
<p>A couple of things to note here. First,
I'm taking advantage of julia's multiple dispatch system.
Instead of writing a separate function name for dealing with
a <code>LongDNA</code> from <code>BioSequences.jl</code>, I wrote a new <em>method</em>
for the same function by adding <code>::LongDNA&lbrace;N&rbrace;</code> to the argument.</p>
<p>This tells julia to call this version of <code>simple_transcribe()</code>
whenever the argument is a <code>LongDNA</code>. Otherwise, it will fall back to the original
(julia always uses the method that is most specific for its arguments).</p>
<p>The last thing to note is the <code>&lbrace;N&rbrace; ... where N</code>. This is just a way
that we can use any DNA alphabet (2 bit or 4 bit), and get similar behavior.</p>
<h3 id="benchmarks" ><a href="#benchmarks"> Benchmarks</a></h3><pre><code class="julia">using BenchmarkTools

testseq = randdnaseq(100_000) #this is defined in BioSequences
testseq_str = string(testseq)

@benchmark simple_transcribe($testseq_str)
@benchmark simple_transcribe(x) setup=(x=LongDNA&lbrace;2&rbrace;(testseq))
@benchmark simple_transcribe(x) setup=(x=LongDNA&lbrace;4&rbrace;(testseq))</code></pre>
<h3 id="conclusions" ><a href="#conclusions"> Conclusions</a></h3><p>The <code>replace()</code> method does surprisingly well,
but the BioJulia method is about 2x faster on a 2-bit sequence
(that is, if there's no ambiguity), and about the same speed on 4-bit sequences.</p>

  <footer class="page-foot">
  <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> BioJulia Developers
   ¬∑ Last modified: 
  <br>
  Built with <a href="https://github.com/tlienart/Xranklin.jl">Xranklin.jl</a>
</footer>

</div>

  </main>
  
    <script src="/BioTutorials/libs/katex/katex.min.js"></script>
<script src="/BioTutorials/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

  
  
    <script src="/BioTutorials/libs/highlight/julia-custom.min.js"></script>
<script>
  // Configure highlight.js to recognize Xranklin's class format
  document.querySelectorAll('pre code').forEach((el) => {
    if (el.className && !el.className.startsWith('language-')) {
      el.classList.add('language-' + el.className.split(' ')[0]);
    }
  });
  hljs.highlightAll();
</script>

  
  <script>
    // Theme toggle functionality
    (function() {
      const toggle = document.getElementById('theme-toggle');
      if (!toggle) return;

      function getSystemTheme() {
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }

      function getCurrentTheme() {
        const stored = localStorage.getItem('theme');
        if (stored) return stored;
        return getSystemTheme();
      }

      function updateHighlightTheme(isDark) {
        const lightStyle = document.getElementById('hljs-light');
        const darkStyle = document.getElementById('hljs-dark');
        if (lightStyle && darkStyle) {
          lightStyle.disabled = isDark;
          darkStyle.disabled = !isDark;
        }
      }

      toggle.addEventListener('click', function() {
        const current = getCurrentTheme();
        const next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        updateHighlightTheme(next === 'dark');
      });

      // Listen for system theme changes
      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
        if (!localStorage.getItem('theme')) {
          // Only update if user hasn't manually set a preference
          document.documentElement.removeAttribute('data-theme');
          updateHighlightTheme(e.matches);
        }
      });
    })();
  </script>
</body>
</html>
